{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "README - API Response Contracts",
  "description": "JSON Schema contracts for platform API responses",
  "content": "# API Response Contracts\n\nThis directory contains JSON Schema definitions for all platform API response structures. These schemas serve as the ground truth for validating TypeScript type definitions against actual API behavior.\n\n## Schema Files\n\n### NewAPI\n- `newapi-balance-response.schema.json` - /api/user/self endpoint\n- `newapi-costs-response.schema.json` - /api/data/self endpoint (array)\n- `newapi-tokens-response.schema.json` - /api/token endpoint (paginated)\n- `newapi-token-groups-response.schema.json` - /api/user/self/groups endpoint\n- `newapi-tenant-info-response.schema.json` - /api/status endpoint\n\n### Cubence\n- `cubence-balance-response.schema.json` - /api/user/self endpoint\n- `cubence-costs-response.schema.json` - /api/data/self endpoint (array)\n- `cubence-tokens-response.schema.json` - /api/token endpoint (paginated)\n- `cubence-token-groups-response.schema.json` - /api/user/self/groups endpoint\n- `cubence-tenant-info-response.schema.json` - /api/v1/dashboard/overview + /api/v1/announcements (merged)\n\n### PackyCode Codex\n- `packycode-codex-balance-response.schema.json` - /api/user/self endpoint\n- `packycode-codex-costs-response.schema.json` - /api/data/self endpoint (array)\n- `packycode-codex-tokens-response.schema.json` - /api/token endpoint (paginated)\n- `packycode-codex-token-groups-response.schema.json` - /api/user/self/groups endpoint\n- `packycode-codex-tenant-info-response.schema.json` - /api/status endpoint\n\n## Usage\n\nThese schemas are used for:\n\n1. **Type Coverage Validation**: Compare TypeScript types against schemas to ensure 100% field coverage\n2. **Automated Testing**: Validate actual API responses in test environments against these schemas\n3. **Documentation**: Serve as authoritative reference for platform API contracts\n4. **Drift Detection**: Monitor API changes by comparing live responses against schemas\n\n## Updating Schemas\n\nWhen a platform API changes:\n\n1. Capture new actual API response from test environment\n2. Update corresponding schema file\n3. Update TypeScript type definitions in `lib/api/types/platforms/`\n4. Update adapter transformation logic in `lib/api/adapters/`\n5. Run coverage validation: `bun run validate-type-coverage`\n6. Ensure all tests pass: `bun run compile`\n\n## Schema Generation\n\nSchemas were initially created by:\n\n1. Capturing actual API responses using browser DevTools or API client\n2. Analyzing response structure (fields, types, required/optional, nesting)\n3. Encoding as JSON Schema Draft-07 format\n4. Validating against multiple response samples to ensure accuracy\n\n## Maintenance Responsibility\n\nPlatform adapter maintainers are responsible for keeping schemas synchronized with type definitions and actual API behavior (per FR-014).\n\n## Sample Schema Structure\n\n```json\n{\n  \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n  \"title\": \"Platform Endpoint Response\",\n  \"description\": \"Response schema for platform /endpoint\",\n  \"type\": \"object\",\n  \"required\": [\"required_field_1\", \"required_field_2\"],\n  \"properties\": {\n    \"required_field_1\": {\n      \"type\": \"number\",\n      \"description\": \"Field description\"\n    },\n    \"optional_field\": {\n      \"type\": \"string\",\n      \"description\": \"Optional field description\"\n    }\n  },\n  \"additionalProperties\": false\n}\n```\n\n**Note**: Only `newapi-balance-response.schema.json` is included as a complete example. Remaining schemas should be generated during implementation by capturing actual API responses from test environments per the research.md guidelines."
}
